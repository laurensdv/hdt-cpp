<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>cds: cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cds
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecds.html">cds</a></li><li class="navelem"><a class="el" href="namespacecds_1_1urcu.html">urcu</a></li><li class="navelem"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html">general_buffered</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>User-space general-purpose RCU with deferred (buffered) reclamation.  
 <a href="classcds_1_1urcu_1_1general__buffered.html#details">More...</a></p>

<p><code>#include &lt;cds/urcu/general_buffered.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classcds_1_1urcu_1_1general__buffered.png" usemap="#cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt;_map" alt=""/>
  <map id="cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt;_map" name="cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt;_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ae4fff792af4e24cf67d379c9be1b8170"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae4fff792af4e24cf67d379c9be1b8170"></a>
typedef <a class="el" href="structcds_1_1urcu_1_1general__buffered__tag.html">general_buffered_tag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#ae4fff792af4e24cf67d379c9be1b8170">rcu_tag</a></td></tr>
<tr class="memdesc:ae4fff792af4e24cf67d379c9be1b8170"><td class="mdescLeft">&#160;</td><td class="mdescRight">RCU tag. <br /></td></tr>
<tr class="separator:ae4fff792af4e24cf67d379c9be1b8170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c81aecd8f106a334802ecc0d43f080"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a29c81aecd8f106a334802ecc0d43f080"></a>
typedef Buffer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a29c81aecd8f106a334802ecc0d43f080">buffer_type</a></td></tr>
<tr class="memdesc:a29c81aecd8f106a334802ecc0d43f080"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer type. <br /></td></tr>
<tr class="separator:a29c81aecd8f106a334802ecc0d43f080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff7b1df771ccc12637131699c0f7501"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ff7b1df771ccc12637131699c0f7501"></a>
typedef Lock&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a6ff7b1df771ccc12637131699c0f7501">lock_type</a></td></tr>
<tr class="memdesc:a6ff7b1df771ccc12637131699c0f7501"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock type. <br /></td></tr>
<tr class="separator:a6ff7b1df771ccc12637131699c0f7501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7a7089c8e44f0d0e7597e00d471b8b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a7a7089c8e44f0d0e7597e00d471b8b"></a>
typedef Backoff&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a1a7a7089c8e44f0d0e7597e00d471b8b">back_off</a></td></tr>
<tr class="memdesc:a1a7a7089c8e44f0d0e7597e00d471b8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Back-off type. <br /></td></tr>
<tr class="separator:a1a7a7089c8e44f0d0e7597e00d471b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84b7dee0092dce0ca54240d33998dd5f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a84b7dee0092dce0ca54240d33998dd5f"></a>
typedef base_class::thread_gc&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a84b7dee0092dce0ca54240d33998dd5f">thread_gc</a></td></tr>
<tr class="memdesc:a84b7dee0092dce0ca54240d33998dd5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread-side RCU part. <br /></td></tr>
<tr class="separator:a84b7dee0092dce0ca54240d33998dd5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4a5a630752ce1a550bcca38be27379"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c4a5a630752ce1a550bcca38be27379"></a>
typedef thread_gc::scoped_lock&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a3c4a5a630752ce1a550bcca38be27379">scoped_lock</a></td></tr>
<tr class="memdesc:a3c4a5a630752ce1a550bcca38be27379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access lock class. <br /></td></tr>
<tr class="separator:a3c4a5a630752ce1a550bcca38be27379"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6ea1f630c53ec769193e1a63766cb46d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a6ea1f630c53ec769193e1a63766cb46d">retire_ptr</a> (<a class="el" href="namespacecds_1_1urcu.html#a9fd06318cc85d4d956ba7fb8152083c1">retired_ptr</a> &amp;p)</td></tr>
<tr class="memdesc:a6ea1f630c53ec769193e1a63766cb46d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retire <code>p</code> pointer.  <a href="#a6ea1f630c53ec769193e1a63766cb46d">More...</a><br /></td></tr>
<tr class="separator:a6ea1f630c53ec769193e1a63766cb46d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d6bfc4f3f1e901a6f1c83d1dc556597"><td class="memTemplParams" colspan="2"><a class="anchor" id="a3d6bfc4f3f1e901a6f1c83d1dc556597"></a>
template&lt;typename ForwardIterator &gt; </td></tr>
<tr class="memitem:a3d6bfc4f3f1e901a6f1c83d1dc556597"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a3d6bfc4f3f1e901a6f1c83d1dc556597">batch_retire</a> (ForwardIterator itFirst, ForwardIterator itLast)</td></tr>
<tr class="memdesc:a3d6bfc4f3f1e901a6f1c83d1dc556597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retires the pointer chain [<code>itFirst</code>, <code>itLast</code>) <br /></td></tr>
<tr class="separator:a3d6bfc4f3f1e901a6f1c83d1dc556597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4be33babbe429d7a7b1e49ad488a356"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4be33babbe429d7a7b1e49ad488a356"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#aa4be33babbe429d7a7b1e49ad488a356">synchronize</a> ()</td></tr>
<tr class="memdesc:aa4be33babbe429d7a7b1e49ad488a356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait to finish a grace period and then clear the buffer. <br /></td></tr>
<tr class="separator:aa4be33babbe429d7a7b1e49ad488a356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ac7d71f713358990fc831df86251d7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7ac7d71f713358990fc831df86251d7"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#ad7ac7d71f713358990fc831df86251d7">capacity</a> () const </td></tr>
<tr class="memdesc:ad7ac7d71f713358990fc831df86251d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns internal buffer capacity. <br /></td></tr>
<tr class="separator:ad7ac7d71f713358990fc831df86251d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a28a13b43fed3290a78b897525ddf7582"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a28a13b43fed3290a78b897525ddf7582"></a>
static <a class="el" href="classcds_1_1urcu_1_1general__buffered.html">general_buffered</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a28a13b43fed3290a78b897525ddf7582">instance</a> ()</td></tr>
<tr class="memdesc:a28a13b43fed3290a78b897525ddf7582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns singleton instance. <br /></td></tr>
<tr class="separator:a28a13b43fed3290a78b897525ddf7582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d71a01bc161dda1f24cfbaa94a8b2d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36d71a01bc161dda1f24cfbaa94a8b2d"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a36d71a01bc161dda1f24cfbaa94a8b2d">isUsed</a> ()</td></tr>
<tr class="memdesc:a36d71a01bc161dda1f24cfbaa94a8b2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the singleton is created and ready to use. <br /></td></tr>
<tr class="separator:a36d71a01bc161dda1f24cfbaa94a8b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15e2a9d98a8cb85b3157d51fbb2ccc6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#ac15e2a9d98a8cb85b3157d51fbb2ccc6">Construct</a> (size_t nBufferCapacity=256)</td></tr>
<tr class="memdesc:ac15e2a9d98a8cb85b3157d51fbb2ccc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates singleton object.  <a href="#ac15e2a9d98a8cb85b3157d51fbb2ccc6">More...</a><br /></td></tr>
<tr class="separator:ac15e2a9d98a8cb85b3157d51fbb2ccc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979ec4ed65bf6664f054b9e368a01a5d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a979ec4ed65bf6664f054b9e368a01a5d"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a979ec4ed65bf6664f054b9e368a01a5d">Destruct</a> (bool bDetachAll=false)</td></tr>
<tr class="memdesc:a979ec4ed65bf6664f054b9e368a01a5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys singleton object. <br /></td></tr>
<tr class="separator:a979ec4ed65bf6664f054b9e368a01a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a7d9817e21fb90fefeb5c9c52ed9973dd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7d9817e21fb90fefeb5c9c52ed9973dd"></a>
static bool const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1urcu_1_1general__buffered.html#a7d9817e21fb90fefeb5c9c52ed9973dd">c_bBuffered</a> = true</td></tr>
<tr class="memdesc:a7d9817e21fb90fefeb5c9c52ed9973dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This RCU buffers disposed elements. <br /></td></tr>
<tr class="separator:a7d9817e21fb90fefeb5c9c52ed9973dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class Buffer = cds::container::VyukovMPMCCycleQueue&lt; epoch_retired_ptr &gt;, class Lock = std::mutex, class Backoff = cds::backoff::Default&gt;<br />
class cds::urcu::general_buffered&lt; Buffer, Lock, Backoff &gt;</h3>

<p>User-space general-purpose RCU with deferred (buffered) reclamation. </p>
<p>This URCU implementation contains an internal buffer where retired objects are accumulated. When the buffer becomes full, the RCU <code>synchronize</code> function is called that waits until all reader/updater threads end up their read-side critical sections, i.e. until the RCU quiescent state will come. After that the buffer and all retired objects are freed. This synchronization cycle may be called in any thread that calls <code>retire_ptr</code> function.</p>
<p>The <code>Buffer</code> contains items of <a class="el" href="namespacecds_1_1urcu.html#cds_urcu_retired_ptr">retired_ptr</a> type and it should support a queue interface with three function:</p><ul>
<li><code> bool push( retired_ptr&amp; p ) </code> - places the retired pointer <code>p</code> into queue. If the function returns <code>false</code> it means that the buffer is full and RCU synchronization cycle must be processed.</li>
<li><code>bool pop( retired_ptr&amp; p ) </code> - pops queue's head item into <code>p</code> parameter; if the queue is empty this function must return <code>false</code> </li>
<li><code>size_t size()</code> - returns queue's item count.</li>
</ul>
<p>The buffer is considered as full if <code>push</code> returns <code>false</code> or the buffer size reaches the RCU threshold.</p>
<p>There is a wrapper <a class="el" href="classcds_1_1urcu_1_1gc_3_01general__buffered_3_01_buffer_00_01_lock_00_01_backoff_01_4_01_4.html#cds_urcu_general_buffered_gc">gc&lt;general_buffered&gt;</a> for <code>general_buffered</code> class that provides unified RCU interface. You should use this wrapper class instead <code>general_buffered</code> </p>
<p>Template arguments:</p><ul>
<li><code>Buffer</code> - buffer type. Default is <a class="el" href="classcds_1_1container_1_1_vyukov_m_p_m_c_cycle_queue.html" title="Vyukov&#39;s MPMC bounded queue. ">cds::container::VyukovMPMCCycleQueue</a></li>
<li><code>Lock</code> - mutex type, default is <code>std::mutex</code> </li>
<li><code>Backoff</code> - back-off schema, default is <a class="el" href="namespacecds_1_1backoff.html#a6d7bf77f149436d5d587a2ec841e5044" title="Default backoff strategy. ">cds::backoff::Default</a> </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac15e2a9d98a8cb85b3157d51fbb2ccc6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Buffer  = cds::container::VyukovMPMCCycleQueue&lt; epoch_retired_ptr &gt;, class Lock  = std::mutex, class Backoff  = cds::backoff::Default&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classcds_1_1urcu_1_1general__buffered.html">cds::urcu::general_buffered</a>&lt; Buffer, Lock, Backoff &gt;::Construct </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nBufferCapacity</em> = <code>256</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates singleton object. </p>
<p>The <code>nBufferCapacity</code> parameter defines RCU threshold. </p>

</div>
</div>
<a class="anchor" id="a6ea1f630c53ec769193e1a63766cb46d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Buffer  = cds::container::VyukovMPMCCycleQueue&lt; epoch_retired_ptr &gt;, class Lock  = std::mutex, class Backoff  = cds::backoff::Default&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classcds_1_1urcu_1_1general__buffered.html">cds::urcu::general_buffered</a>&lt; Buffer, Lock, Backoff &gt;::retire_ptr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacecds_1_1urcu.html#a9fd06318cc85d4d956ba7fb8152083c1">retired_ptr</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retire <code>p</code> pointer. </p>
<p>The method pushes <code>p</code> pointer to internal buffer. When the buffer becomes full <a class="el" href="classcds_1_1urcu_1_1general__buffered.html#aa4be33babbe429d7a7b1e49ad488a356">synchronize</a> function is called to wait for the end of grace period and then to free all pointers from the buffer. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>cds/urcu/details/gpb.h</li>
</ul>
</div><!-- contents -->
<hr/>
<div align="right">
  <b>cds</b> <b>2.0.0</b> 
  Developed by <i>Maxim Khiszinsky aka khizmax</i> 2007 - 2014
  <br/>
  <i>Autogenerated Tue Dec 30 2014 08:53:28 by Doxygen 1.8.8</i>
</div>
</body>
</html>
